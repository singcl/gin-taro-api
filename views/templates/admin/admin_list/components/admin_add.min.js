import{h,reactive,ref,toRef}from"/views/static/js/vue/vue3.esm-browser.js";import naive from"/views/static/js/vue/naive.js";import Kiko from"/views/static/js/utils/kiko/Kiko.js";const{NModal,NCard,NForm,NFormItem,NInput,useMessage}=naive;export default{props:{visible:Boolean},emits:["update:visible","kiko:conform"],setup(e,a){const t=useMessage(),r=toRef(e,"visible"),s=reactive({username:void 0,nickname:void 0,mobile:void 0,password:void 0}),i=ref(null),o=reactive({username:[{required:!0,trigger:"blur",message:"请输入用户名"},{pattern:/^[a-z][a-z0-9_]{5,11}$/,message:"用户名长度必须在6-12位之间，以小写字母开头且只能包含字母数字下划线",trigger:"blur"}],nickname:[{required:!0,trigger:"blur",message:"请输入昵称"},{pattern:/^[^0-9-][a-zA-Z0-9\u4e00-\u9fa5_-]{5,11}$/,message:"昵称长度必须在6-12位之间，只能包含字母数字下划线中划线中文",trigger:"blur"}],mobile:[{required:!0,trigger:"blur",message:"请输入手机号"},{pattern:/^1[34578]\d{9}$/,message:"请输入正确的手机号码",trigger:"blur"}],password:[{required:!0,trigger:"blur",message:"请输入密码"},{pattern:/^(?![a-zA-Z]+$)(?![A-Z0-9]+$)(?![A-Z\W_]+$)(?![a-z0-9]+$)(?![a-z\W_]+$)(?![0-9\W_]+$)[a-zA-Z0-9\W_]{8,20}$/,message:"请输入8-20位字符，必须包含大写字母小写字母和数字",trigger:"blur"}]});async function l(){var e=await i.value?.validate();try{await(new Kiko).fetch("/api/admin",{method:"POST",body:s}),t.success("创建成功"),m(),a.emit("kiko:conform",e)}catch(e){t.error(`创建失败:code: ${e.code};message: `+e.message)}}const m=()=>{a.emit("update:visible",!1)};return()=>h(NModal,{show:r.value,title:"新增管理员",preset:"dialog",content:()=>h(NCard,()=>h(NForm,{model:s,rules:o,ref:i,labelPlacement:"left",labelWidth:"120px"},()=>[h(NFormItem,{label:"用户名",path:"username"},()=>h(NInput,{value:s.username,"onUpdate:value":e=>s.username=e,type:"text",placeholder:"请输入用户名"})),h(NFormItem,{label:"昵称",path:"nickname"},()=>h(NInput,{value:s.nickname,"onUpdate:value":e=>s.nickname=e,type:"text",placeholder:"请输入昵称"})),h(NFormItem,{label:"手机号",path:"mobile"},()=>h(NInput,{value:s.mobile,"onUpdate:value":e=>s.mobile=e,type:"text",placeholder:"请输入手机号"})),h(NFormItem,{label:"密码",path:"password"},()=>h(NInput,{value:s.password,"onUpdate:value":e=>s.password=e,type:"password",placeholder:"请输入密码"}))])),positiveText:"确认",negativeText:"取消",onNegativeClick:m,onPositiveClick:l,style:{width:"900px"}})}};