import{h,reactive,ref,toRef}from"/views/static/js/vue/vue3.esm-browser.js";import naive from"/views/static/js/vue/naive.js";import Kiko from"/views/static/js/utils/kiko/Kiko.js";const{NModal,NCard,NForm,NFormItem,NInput,NSelect,useMessage}=naive,methodOptionsConfig=[{label:"POST",value:"POST"},{label:"GET",value:"GET"},{label:"PUT",value:"PUT"},{label:"DELETE",value:"DELETE"},{label:"PATCH",value:"PATCH"}];export default{props:{visible:Boolean,detailData:Object},emits:["update:visible","kiko:conform"],setup(e,t){const a=useMessage(),i=toRef(e,"visible"),o=toRef(e,"detailData"),l=reactive(methodOptionsConfig),s=reactive({method:void 0,api:void 0}),r=ref(null),v=reactive({method:{required:!0,trigger:"blur",message:"请选择请求方式"},api:{required:!0,trigger:"blur",message:"请输入接口地址"}});async function d(){var e=await r.value?.validate();try{await(new Kiko).fetch("/api/authorized_api",{method:"POST",body:{...s,id:o.value.hashid}}),a.success("创建成功"),m(),t.emit("kiko:conform",e)}catch(e){a.error(`API授权失败:code: ${e.code};message: `+e.message)}}const m=()=>{t.emit("update:visible",!1)};return()=>h(NModal,{show:i.value,title:"新增API授权",preset:"dialog",content:()=>h(NCard,()=>h(NForm,{model:s,rules:v,ref:r,labelPlacement:"left",labelWidth:"120px"},()=>[h(NFormItem,{label:"请求方式",path:"method"},()=>h(NSelect,{value:s.method,"onUpdate:value":e=>s.method=e,options:l,placeholder:"请选择请求方式"})),h(NFormItem,{label:"接口地址",path:"api"},()=>h(NInput,{value:s.api,"onUpdate:value":e=>s.api=e,type:"text",placeholder:"请输入接口地址"}))])),positiveText:"确认",negativeText:"取消",onNegativeClick:m,onPositiveClick:d,style:{width:"900px"}})}};